prestige_total_calculate = {
	clear_array = global.prestige_total_ranking_scope_array
	clear_array = global.prestige_total_ranking_score_array
	every_country = {
		# Calculate
			set_variable = {
				var = prestige_total
				value = mtth:prestige_total
			}
			set_variable = {
				var = prestige_achievement
				value = mtth:prestige_achievement
			}
			set_variable = {
				var = prestige_humanities
				value = mtth:prestige_humanities
			}
			set_variable = {
				var = prestige_innovation
				value = mtth:prestige_innovation
			}
			set_variable = {
				var = prestige_economy
				value = mtth:prestige_economy
			}
			set_variable = {
				var = prestige_military
				value = mtth:prestige_military
			}
			set_variable = {
				var = prestige_empire
				value = mtth:prestige_empire
			}
		# Sort	

			for_each_loop = {
				array = global.prestige_total_ranking_score_array
				index = ii
				value = vv
				break = bb
				if = {
					limit = {
						check_variable = {
							vv < prestige_total
						}
					}
					add_to_array = {
						array = global.prestige_total_ranking_score_array
						value = prestige_total
						index = ii
					}
					add_to_array = {
						array = global.prestige_total_ranking_scope_array
						value = THIS.id
					}
					set_temp_variable = {
						bb = 1
					}
				}
			}
	}
	# Populate
		for_each_scope_loop = {
			array = global.prestige_total_ranking_scope_array
			index = ii
			break = bb

			set_variable = {
				var = prestige_rank
				value = ii
			}
		}
}
